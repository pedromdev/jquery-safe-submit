!function(t){function n(e){var r=this;if(null===e)return null;if(Array.isArray(e))return e.map(n.bind(r));switch(typeof e){case"function":return e.call(r);case"string":return function(e){var r=t(this),a=null,c=/(\{[^}]+\})/g;try{a=r.find(e)}catch(t){}if(null!==a&&a.length>0)return 1===a.length?a.val():a.map(function(n,e){return t(e).val()}).get();if(c.test(e)){var o=e.match(c).reduce(function(t,n){return Object.assign(t,{[n]:n.replace(/[\{\}]/g,"")})},{});return o=n.call(this,o),Object.keys(o).forEach(function(t){e=e.replace(t,o[t])}),e}return e}.call(r,e);case"object":return Object.keys(e).reduce(function(t,a){return Object.assign(t,{[a]:n.call(r,e[a])})},{});default:return e}}function e(){}t.fn.lockableSubmit=function(n){var e=t(this);return e.data("lockableSubmitHandlers")||(e.data("lockableSubmitHandlers",[]),e.submit(function(t){var n=e.data("lockableSubmitHandlers");n.filter(function(t){return t.unlocked}).length<n.length?(t.preventDefault(),t.stopPropagation(),n.filter(function(t){return!t.flagged}).forEach(function(n){n.flagged=!0,n(t,function(){n.unlocked=!0,e.submit()},function(){n.flagged=!1})})):n.forEach(function(t){t.flagged=!1,t.unlocked=!1})})),e.data("lockableSubmitHandlers").push(n.bind(this)),this},t.fn.serviceUrl=function(n,e="GET"){var r=t(this);return r.data("service:actions")||r.data("service:actions",[]),"string"==typeof e&&/^(GET|POST|PUT|PATCH|DELETE)$/i.test(e)?e={method:e}:"object"==typeof e&&null!==e||(e={}),e.url=n,r.data("service:actions").push(e),this},t.fn.fieldsMap=function(r,a){var c=this,o=t(this);if(!o.data("service:actions")||0===o.data("service:actions").length)return console.error("É necessário fazer uma chamada ao método 'serviceUrl' para configurar um URL de envio"),this;if("object"!=typeof r||null===r)return console.error("É necessário informar um objeto dos campos a serem enviados para o serviço"),this;"object"==typeof a&&null!==a||(a={});var i=o.data("service:actions").shift();return"function"!=typeof a.onStart&&(a.onStart=e),"function"!=typeof a.onError&&(a.onError=e),"function"!=typeof a.onSucess&&(a.onSucess=e),o.lockableSubmit(function(e,o,s){try{a.onStart.call(this,e);var u=function(n,e){switch(e.method){case"GET":return t.params(n);case"POST":case"PUT":case"PATCH":case"DELETE":return e.contentType="application/json; charset=UTF-8",JSON.stringify(n);default:return n}}(n.call(this,r),i);i.data=u,t.ajax(i).done(function(t){a.onSuccess.call(c,t),o()}).fail(function(t,n,e){s(),a.onError.call(c,e)})}catch(t){s(),a.onError.call(this,t)}})}}(jQuery);
